# –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### Backend API
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (JWT)
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞–º–∏ (CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏)
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ (—Ç–æ–∫–µ–Ω—ã)
- ‚úÖ WebSocket —Ç—É–Ω–Ω–µ–ª—å –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
- ‚úÖ HTTP proxy –¥–ª—è –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞–º
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –º–µ—Ç—Ä–∏–∫ (–±–∞–∑–æ–≤–∞—è)
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL —Å –ø–æ–ª–Ω–æ–π —Å—Ö–µ–º–æ–π
- ‚úÖ Redis –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å–µ—Å—Å–∏–π
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (Winston)
- ‚úÖ Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- ‚úÖ Docker Compose –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–ø—Ä–∏–º–µ—Ä)
- ‚úÖ SSL/TLS –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (Let's Encrypt)

## üîÑ –¢—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏

### 1. ESP32 –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å WebSocket –∫–ª–∏–µ–Ω—Ç –Ω–∞ ESP32 –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ SaaS —Å–µ—Ä–≤–µ—Ä—É:

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- WebSocket –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è ESP32
- –õ–æ–≥–∏–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ `wss://wmoc.online/tunnel`
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Å QR-–∫–æ–¥–æ–º/–≤–≤–æ–¥–æ–º —Ç–æ–∫–µ–Ω–∞

**–ü—Ä–∏–º–µ—Ä–Ω—ã–π –∫–æ–¥ –¥–ª—è ESP32:**
```cpp
// –í main.cpp –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:
#include <WebSocketsClient.h>

WebSocketsClient webSocket;

void webSocketEvent(WStype_t type, uint8_t * payload, size_t length) {
  switch(type) {
    case WStype_CONNECTED:
      // –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
      break;
    case WStype_TEXT:
      // –û–±—Ä–∞–±–æ—Ç–∞—Ç—å HTTP –∑–∞–ø—Ä–æ—Å –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
      break;
  }
}

void connectToSaaS() {
  webSocket.beginSSL("wmoc.online", 443, "/tunnel");
  webSocket.onEvent(webSocketEvent);
}
```

### 2. Frontend Portal
–°–æ–∑–¥–∞—Ç—å React/Next.js –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞:

**–°—Ç—Ä–∞–Ω–∏—Ü—ã:**
- `/login` - –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
- `/register` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- `/dashboard` - –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ —Å–ø–∏—Å–∫–æ–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
- `/controllers/:id` - –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ
- `/controllers/:id/settings` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
- `/controllers/:id/monitor` - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—É)
- `/notifications` - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:**
- Next.js 14+ (App Router)
- TypeScript
- Tailwind CSS
- React Query –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
- WebSocket –∫–ª–∏–µ–Ω—Ç –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

### 3. –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–º–∞–Ω–¥ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞–º —á–µ—Ä–µ–∑ WebSocket:

**API Endpoint:**
```typescript
POST /api/controllers/:id/commands
{
  "command": "relay",
  "params": { "id": 1, "state": true }
}
```

**WebSocket —Å–æ–æ–±—â–µ–Ω–∏–µ:**
```json
{
  "type": "command",
  "command": "relay",
  "params": { "id": 1, "state": true }
}
```

### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Prometheus –¥–ª—è –º–µ—Ç—Ä–∏–∫
- Grafana –¥–∞—à–±–æ—Ä–¥—ã
- –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 5. –ü–æ–¥–ø–∏—Å–∫–∏ –∏ –ø–ª–∞—Ç–µ–∂–∏
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã (Stripe/YooKassa)
- –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–ø–∏—Å–æ–∫ (free, basic, premium)
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
- –ë–∏–ª–ª–∏–Ω–≥

### 6. Email/SMS —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SMTP/SMS –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
- –®–∞–±–ª–æ–Ω—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 7. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- Rate limiting –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ó–∞—â–∏—Ç–∞ –æ—Ç DDoS
- –ê—É–¥–∏—Ç –ª–æ–≥–æ–≤
- –î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## üìã –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
1. WebSocket –∫–ª–∏–µ–Ω—Ç –¥–ª—è ESP32
2. Frontend Portal (–±–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è)
3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ–π —Ü–µ–ø–æ—á–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
4. –°–∏—Å—Ç–µ–º–∞ –∫–æ–º–∞–Ω–¥
5. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
6. –£–ª—É—á—à–µ–Ω–∏–µ UI/UX

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
7. –ü–æ–¥–ø–∏—Å–∫–∏ –∏ –ø–ª–∞—Ç–µ–∂–∏
8. Email/SMS —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
9. –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å backend: `npm run dev`
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL –∏ Redis —á–µ—Ä–µ–∑ Docker Compose
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API —á–µ—Ä–µ–∑ Postman/curl
4. –ü–æ–¥–∫–ª—é—á–∏—Ç—å ESP32 –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—É (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–æ–º–µ–Ω –∏ SSL
3. –ü–æ–¥–∫–ª—é—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π ESP32 –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª: —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –∞–∫—Ç–∏–≤–∞—Ü–∏—è ‚Üí –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [WebSocket –¥–ª—è ESP32](https://github.com/Links2004/arduinoWebSockets)
- [Next.js –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://nextjs.org/docs)
- [Let's Encrypt](https://letsencrypt.org/)
- [Nginx –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](https://nginx.org/en/docs/)

